Hardware
========

Overview
--------

.. figure:: _static/TDC-module_top.png
    :alt: TimeTagger Module Top

    Top-view of a TimeTagger Module.

.. figure:: _static/TDC-Module_underneath.png
    :alt: TimeTagger Module Bottom

    Bottom-view of a TimeTagger Module. For the pin assignment, see
    :numref:`Section %s<pin assignment>`.

Inputs and Outputs
------------------

.. figure:: _static/diagram.*
    :alt: Block Diagram

    Block diagram giving an overview of the inputs and outputs of the
    TimeTagger Module.


.. _pin assignment:

Pin Assignment
--------------

.. warning::

    This user guide is under development. The Pin-Assignment below is subject
    to change.

JB1-Connector
^^^^^^^^^^^^^

.. table::
    :width: 100%
    :widths: 15 1 1 15 1 15 1 1 15

    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | Name                 | Pin | Pin | Name            || Name       | Pin | Pin |  Name           |
    +======================+=====+=====+=================++============+=====+=====+=================+
    | PCIe_RX3_P           |  1  |  2  | PCIe_100M_CLK_P ||            | 51  | 52  |                 |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | PCIe_RX3_N           |  3  |  4  | PCIe_100M_CLK_N ||            | 53  | 54  | DAC_EN2         |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    |  GND                 |  5  |  6  | GND             ||            | 55  | 56  | DAC_RST         |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | PCIe_RX2_P           |  7  |  8  | PCIe_TX3_P      ||            | 57  | 58  | DAC_DIN         |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | PCIe_RX2_N           |  9  | 10  | PCIe_TX3_N      ||            | 59  | 60  | DAC_SCLK        |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    |  GND                 | 11  | 12  | GND             || VCC33      | 61  | 62  | DAC_EN1         |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | PCIe_RX1_P           | 13  | 14  | PCIe_TX2_P      ||            | 63  | 64  | DAC_SYNC        |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | PCIe_RX1_N           | 15  | 16  | PCIe_TX2_N      ||            | 65  | 66  | GND             |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    |  GND                 | 17  | 18  | GND             ||            | 67  | 68  |                 |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | PCIe_RX0_P           | 19  | 20  | PCIe_TX1_P      ||            | 69  | 70  |                 |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | PCIe_RX0_N           | 21  | 22  | PCIe_TX1_N      ||            | 71  | 72  |                 |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    |  GND                 | 23  | 24  | GND             ||            | 73  | 74  |                 |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    |                      | 25  | 26  | PCIe_TX0_P      ||            | 75  | 76  |                 |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | GND                  | 27  | 28  | PCIe_TX0_N      ||            | 77  | 78  |                 |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | GND                  | 29  | 30  | GND             ||            | 79  | 80  |                 |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | PCIe_SMCLK           | 31  | 32  | TiGer_OE_STOP1  ||            | 81  | 82  | LED_STAT        |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | PCIe_SMDAT           | 33  | 34  | TiGer_STOP2     || 3.3 V Test | 83  | 84  | GND             |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | FAN_PWM              | 35  | 36  | TiGer_STOP1     ||            | 85  | 86  | JTAG_TDI        |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | FAN_TACHO            | 37  | 38  | TiGer_OE_STOP2  ||            | 87  | 88  | JTAG_TDO        |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | TiGer_OE_STOP0       | 39  | 40  | TiGer_STOP3     ||            | 89  | 90  | JTAG_TCK        |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | TiGer_OE_START       | 41  | 42  | TiGer_OE_STOP3  ||            | 91  | 92  | JTAG_TMS        |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | TiGer_STOP0          | 43  | 44  |                 ||            | 93  | 94  |  PROG_n         |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | TiGer_START          | 45  | 46  |                 || GND        | 95  | 96  |  DONE           |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | GND                  | 47  | 48  |  GND            || VCC33      | 97  | 98  |   GND           |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    | PERST_n              | 49  | 50  |                 || VCC33      | 99  | 100 |  GND            |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+
    |                      |     |     |                 ||  GND       | F1  | F2  |   GND           |
    +----------------------+-----+-----+-----------------++------------+-----+-----+-----------------+


JB2-Connector
^^^^^^^^^^^^^


.. table::
    :width: 100%
    :widths: 15 1 1 15 1 15 1 1 15

    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    | Name             | Pin | Pin | Name           || Name              | Pin | Pin | Name       |
    +==================+=====+=====+================++===================+=====+=====+============+
    |                  |  1  |  2  |                || START_LVDS_N      | 51  | 52  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  |  3  |  4  |                ||                   | 53  | 54  | VCC25      |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  |  5  |  6  |                ||                   | 55  | 56  | POWON      |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  |  7  |  8  |                || LED_GN            | 57  | 58  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  |  9  | 10  | FPGA_STOP3_N   || LED_RED           | 59  | 60  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 11  | 12  | FPGA_STOP3_P   ||  CLK_SYNC         | 61  | 62  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 13  | 14  | FPGA_STOP2_N   ||  CLK_SPI_MISO     | 63  | 64  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 15  | 16  | FPGA_STOP2_P   ||  CLK_SPI_MOSI     | 65  | 66  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    | GND              | 17  | 18  |                ||                   | 67  | 68  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 19  | 20  |                ||                   | 69  | 70  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 21  | 22  |                ||                   | 71  | 72  |   GND      |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 23  | 24  |                ||                   | 73  | 74  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 25  | 26  |                ||  CLK_SPI_CLK      | 75  | 76  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 27  | 28  |                ||  CLK_SPI_LE       | 77  | 78  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 29  | 30  |                ||  CLK_REF_SEL      | 79  | 80  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 31  | 32  | TDC_150M_CLK_P ||  CLK_SPI_PLL_LOCK | 81  | 82  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 33  | 34  | TDC_150M_CLK_N || GND               | 83  | 84  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    | GND              | 35  | 36  |  GND           ||                   | 85  | 86  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 37  | 38  |                ||                   | 87  | 88  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  | 39  | 40  |                ||                   | 89  | 90  | GND        |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    | STOP_LVDS1_N     | 41  | 42  |                ||                   | 91  | 92  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    | STOP_LVDS1_P     | 43  | 44  |                ||                   | 93  | 94  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    | STOP_LVDS0_N     | 45  | 46  |                ||                   | 95  | 96  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    | STOP_LVDS0_P     | 47  | 48  |                ||                   | 97  | 98  |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    | START_LVDS_P     | 49  | 50  |                ||                   | 99  | 100 |            |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+
    |                  |     |     |                ||  GND              | F1  | F2  |   GND      |
    +------------------+-----+-----+----------------++-------------------+-----+-----+------------+

PCIe Example Setup
------------------

.. figure:: _static/module_on_PCIe_board.png
    :alt: PCIe Board Setup

    Example setup of a TimeTagger Module on a PCIe board.